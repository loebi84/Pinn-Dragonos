- name: 🧠 DragonOS-Link dynamisch holen
  id: get-dragonos
  run: |
    echo "📡 RSS-Feed wird analysiert…"
    feed_url="https://sourceforge.net/projects/dragonos/rss?path=/DragonOS_Pi64"
    latest_url=$(curl -s "$feed_url" | grep -oP 'url="\Khttps://.*?\.img\.xz(?=")' | head -n 1)

    if [ -z "$latest_url" ]; then
      echo "❌ Kein Download-Link gefunden!"
      exit 1
    fi

    echo "✅ Gefundener Link: $latest_url"
    echo "dragonos_url=$latest_url" >> $GITHUB_OUTPUT

- name: 📥 DragonOS herunterladen
  run: |
    echo "📦 Lade DragonOS von: ${{ steps.get-dragonos.outputs.dragonos_url }}"
    wget -O dragonos.img.xz "${{ steps.get-dragonos.outputs.dragonos_url }}"