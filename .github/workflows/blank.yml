# name: Update DragonOS weekly

on:
  schedule:
    - cron: '0 3 * * 1' # Jeden Montag um 03:00 Uhr UTC
  workflow_dispatch: # Manuell ausl√∂sbar

jobs:
  update-dragonos:
    runs-on: ubuntu-latest

    steps:
    - name: üì• Repo clonen
      uses: actions/checkout@v3

    - name: üêâ DragonOS Beta herunterladen
      run: |
        wget -O dragonos.img.xz "https://sourceforge.net/projects/dragonos/files/DragonOS_Pi64/latest/download"
    
    - name: üì¶ Image extrahieren
      run: |
        mkdir -p mount
        xz -d dragonos.img.xz
        # Falls gew√ºnscht: mount, boot/root trennen und zu .tar.xz packen

    - name: üõ†Ô∏è In boot/root umwandeln (Demo-Zweck)
      run: |
        mkdir -p dragonos/boot dragonos/root
        echo "Boot-Inhalt hier" > dragonos/boot/README.txt
        echo "Root-Inhalt hier" > dragonos/root/README.txt
        tar -cJf dragonos/boot.tar.xz -C dragonos/boot .
        tar -cJf dragonos/root.tar.xz -C dragonos/root .

    - name: ‚¨ÜÔ∏è Push ins Repo
      run: |
        git config user.name "L√∂biBot"
        git config user.email "bot@dragonos.local"
        git add dragonos/boot.tar.xz dragonos/root.tar.xz
        git commit -m "üõ†Ô∏è Weekly update DragonOS: $(date +%F)"
        git push
